{"modules":[{"id":"856dd865-e5a0-49c6-aacc-55fe53c38a22","type":"SetLoggingBehavior","branches":[{"condition":"Success","transition":"53e6aa2b-e374-4ae6-bfc9-1285d2ac202f"}],"parameters":[{"name":"LoggingBehavior","value":"Enable"}],"metadata":{"position":{"x":181,"y":15}}},{"id":"c8784af8-ed06-4275-8397-a446c065cc60","type":"SetAttributes","branches":[{"condition":"Success","transition":"6e095c22-c54b-4af5-aa03-9e3f1ca3ba50"},{"condition":"Error","transition":"6e095c22-c54b-4af5-aa03-9e3f1ca3ba50"}],"parameters":[{"name":"Attribute","value":"empid","key":"EmpID","namespace":"Lex.Slots"}],"metadata":{"position":{"x":292,"y":258}}},{"id":"e2144a3d-1f3c-458a-847c-f725f2f52b0e","type":"GetUserInput","branches":[{"condition":"Evaluate","conditionType":"Equals","conditionValue":"EmpIdFourDigit","transition":"c8784af8-ed06-4275-8397-a446c065cc60"},{"condition":"Evaluate","conditionType":"Equals","conditionValue":"#","transition":"c8784af8-ed06-4275-8397-a446c065cc60"},{"condition":"NoMatch","transition":"c8784af8-ed06-4275-8397-a446c065cc60"},{"condition":"Error","transition":"c8784af8-ed06-4275-8397-a446c065cc60"}],"parameters":[{"name":"Text","value":"Please enter your 4-digit employee number. When you're done, please press pound.","namespace":null},{"name":"TextToSpeechType","value":"text"},{"name":"BotName","value":"RecordComprehendTask"},{"name":"BotAlias","value":"$LATEST"},{"name":"BotRegion","value":"us-west-2"}],"metadata":{"position":{"x":55,"y":250},"conditionMetadata":[{"id":"9ea24b9c-d810-4302-b952-6e295d8eb73c","value":"EmpIdFourDigit"},{"id":"09ef6573-a0e8-4a9e-8908-3bc1567da407","value":"#"}],"useDynamic":false,"dynamicMetadata":{}},"target":"Lex"},{"id":"53e6aa2b-e374-4ae6-bfc9-1285d2ac202f","type":"SetRecordingBehavior","branches":[{"condition":"Success","transition":"f6d8ccf2-a608-4c5a-9179-7b3c11473adf"}],"parameters":[{"name":"RecordingBehaviorOption","value":"Enable"},{"name":"RecordingParticipantOption","value":"Both"}],"metadata":{"position":{"x":420,"y":19}}},{"id":"6e095c22-c54b-4af5-aa03-9e3f1ca3ba50","type":"InvokeExternalResource","branches":[{"condition":"Success","transition":"6728609a-9707-41f7-a87c-30ac1fde4f4c"},{"condition":"Error","transition":"6728609a-9707-41f7-a87c-30ac1fde4f4c"}],"parameters":[{"name":"FunctionArn","value":"arn:aws:lambda:us-west-2:985176756686:function:record-comprend-task-trackingtasklambdafunction500-g0ZTTotxCGVn","namespace":null},{"name":"TimeLimit","value":"3"},{"name":"Parameter","key":"ANI","value":"Customer Number","namespace":"System"},{"name":"Parameter","key":"ContactID","value":"ContactId","namespace":"System"},{"name":"Parameter","key":"EmpID","value":"EmpID","namespace":"User Defined"}],"metadata":{"position":{"x":560,"y":238},"dynamicMetadata":{"ANI":true,"ContactID":true,"EmpID":true},"useDynamic":false},"target":"Lambda"},{"id":"f6d8ccf2-a608-4c5a-9179-7b3c11473adf","type":"CheckAttribute","branches":[{"condition":"Evaluate","conditionType":"Equals","conditionValue":"TASK","transition":"4542e608-c29b-4f06-bb02-87debc2c7daf"},{"condition":"NoMatch","transition":"e2144a3d-1f3c-458a-847c-f725f2f52b0e"}],"parameters":[{"name":"Attribute","value":"Channel"},{"name":"Namespace","value":"System"}],"metadata":{"position":{"x":884,"y":35},"conditionMetadata":[{"operator":{"name":"Equals","value":"Equals","shortDisplay":"="},"value":"TASK","id":"937f86be-ff7b-4922-a3a1-dc7ee3c85c27"}]}},{"id":"6728609a-9707-41f7-a87c-30ac1fde4f4c","type":"StartMediaStreaming","branches":[{"condition":"Success","transition":"e7825b58-a9db-4935-9f83-e67a564176e8"},{"condition":"Error","transition":"410057d0-9390-486b-bbb4-c4def2a7367c"}],"parameters":[{"name":"Track","value":"FromCustomer"},{"name":"Track","value":"ToCustomer"},{"name":"MediaStreamTypes","value":"Audio"}],"metadata":{"position":{"x":853,"y":245},"fromCustomer":true,"toCustomer":true}},{"id":"87d86467-7186-4a2f-a33d-172c51149ac1","type":"InvokeExternalResource","branches":[{"condition":"Success","transition":"2e769fc1-0678-4293-87dd-cd5e53ecbc31"},{"condition":"Error","transition":"aa21389d-0252-465c-80ec-2c9ea9a83b19"}],"parameters":[{"name":"FunctionArn","value":"arn:aws:lambda:us-west-2:985176756686:function:connect-comprehend-task-kvsConsumerTrigger-D7QSNHDVHNSD","namespace":null},{"name":"TimeLimit","value":"8"}],"metadata":{"position":{"x":123,"y":570},"dynamicMetadata":{},"useDynamic":false},"target":"Lambda"},{"id":"2e769fc1-0678-4293-87dd-cd5e53ecbc31","type":"GetUserInput","branches":[{"condition":"Evaluate","conditionType":"Equals","conditionValue":"#","transition":"2194abd8-0e2b-4640-8475-07341ac59d4a"},{"condition":"Timeout","transition":"2194abd8-0e2b-4640-8475-07341ac59d4a"},{"condition":"NoMatch","transition":"2194abd8-0e2b-4640-8475-07341ac59d4a"},{"condition":"Error","transition":"2194abd8-0e2b-4640-8475-07341ac59d4a"}],"parameters":[{"name":"Text","value":"<speak>\n<amazon:domain name=\"conversational\"> Thank you for calling, please leave a message describing any details about how you're feeling and where you've been. Press pound when you are done.\n</amazon:domain> </speak>","namespace":null},{"name":"TextToSpeechType","value":"ssml"},{"name":"Timeout","value":"30"},{"name":"MaxDigits","value":"1"}],"metadata":{"position":{"x":441,"y":659},"conditionMetadata":[{"id":"a96b433f-19af-4856-b9fa-a326f06b9bba","value":"#"}],"useDynamic":false},"target":"Digits"},{"id":"2194abd8-0e2b-4640-8475-07341ac59d4a","type":"StopMediaStreaming","branches":[{"condition":"Success","transition":"69afee5e-0afc-437c-8216-0209281b439c"},{"condition":"Error","transition":"69afee5e-0afc-437c-8216-0209281b439c"}],"parameters":[{"name":"Track","value":"FromCustomer"},{"name":"Track","value":"ToCustomer"},{"name":"MediaStreamTypes","value":"Audio"}],"metadata":{"position":{"x":829,"y":672}}},{"id":"85973e7c-2d33-40db-9867-dc162d6920c7","type":"Transfer","branches":[{"condition":"AtCapacity","transition":"99458f47-6941-48ce-9b90-fdf184759b22"},{"condition":"Error","transition":"99458f47-6941-48ce-9b90-fdf184759b22"}],"parameters":[],"metadata":{"position":{"x":1376,"y":35},"useDynamic":false,"queue":null},"target":"Queue"},{"id":"4542e608-c29b-4f06-bb02-87debc2c7daf","type":"SetQueue","branches":[{"condition":"Success","transition":"85973e7c-2d33-40db-9867-dc162d6920c7"},{"condition":"Error","transition":"99458f47-6941-48ce-9b90-fdf184759b22"}],"parameters":[{"name":"Queue","value":"arn:aws:connect:us-west-2:985176756686:instance/aa67c4a9-d500-4721-9613-99e0123cc42c/queue/c5b01e34-4b83-469d-bb21-31df2b156b51","namespace":null,"resourceName":"BasicQueue"}],"metadata":{"position":{"x":1154,"y":57},"useDynamic":false,"queue":{"id":"arn:aws:connect:us-west-2:985176756686:instance/aa67c4a9-d500-4721-9613-99e0123cc42c/queue/c5b01e34-4b83-469d-bb21-31df2b156b51","text":"BasicQueue"}}},{"id":"410057d0-9390-486b-bbb4-c4def2a7367c","type":"PlayPrompt","branches":[{"condition":"Success","transition":"99458f47-6941-48ce-9b90-fdf184759b22"}],"parameters":[{"name":"Text","value":"An error occurred when we tried to start streaming.","namespace":null},{"name":"TextToSpeechType","value":"text"}],"metadata":{"position":{"x":1169,"y":267},"useDynamic":false}},{"id":"e7825b58-a9db-4935-9f83-e67a564176e8","type":"SetAttributes","branches":[{"condition":"Success","transition":"87d86467-7186-4a2f-a33d-172c51149ac1"},{"condition":"Error","transition":"99458f47-6941-48ce-9b90-fdf184759b22"}],"parameters":[{"name":"Attribute","value":"true","key":"transcribeCall","namespace":null},{"name":"Attribute","value":"true","key":"saveCallRecording","namespace":null},{"name":"Attribute","value":"aid","key":"aid","namespace":"External"},{"name":"Attribute","value":"sak","key":"sak","namespace":"External"},{"name":"Attribute","value":"sst","key":"sst","namespace":"External"},{"name":"Attribute","value":"true","key":"streamAudioFromCustomer","namespace":null},{"name":"Attribute","value":"true","key":"streamAudioToCustomer","namespace":null},{"name":"Attribute","value":"en-US","key":"languageCode","namespace":null}],"metadata":{"position":{"x":1206,"y":442}}},{"id":"aa21389d-0252-465c-80ec-2c9ea9a83b19","type":"PlayPrompt","branches":[{"condition":"Success","transition":"99458f47-6941-48ce-9b90-fdf184759b22"}],"parameters":[{"name":"Text","value":"An error occurred with the KVS trigger lambda function.","namespace":null},{"name":"TextToSpeechType","value":"text"}],"metadata":{"position":{"x":126,"y":850},"useDynamic":false}},{"id":"69afee5e-0afc-437c-8216-0209281b439c","type":"PlayPrompt","branches":[{"condition":"Success","transition":"99458f47-6941-48ce-9b90-fdf184759b22"}],"parameters":[{"name":"Text","value":"Thank you. Your response has been recorded successfully. We have created a task for an agent and they will get back to you when they are available.","namespace":null},{"name":"TextToSpeechType","value":"text"}],"metadata":{"position":{"x":1156,"y":702},"useDynamic":false}},{"id":"99458f47-6941-48ce-9b90-fdf184759b22","type":"Disconnect","branches":[],"parameters":[],"metadata":{"position":{"x":1640,"y":416}}}],"version":"1","type":"contactFlow","start":"856dd865-e5a0-49c6-aacc-55fe53c38a22","metadata":{"entryPointPosition":{"x":15,"y":19},"snapToGrid":false,"name":"kvsStreamingFlow","description":null,"type":"contactFlow","status":"published","hash":"39a38c8869bcf1dba6e50989b2e033a583bf9f03110d12bec3268b1e681925cb"}}